{% extends "layers/layer_detail.html" %}
{% load leaflet_tags %}
{% block head %}
{{ block.super }}

{% leaflet_css %}
{% leaflet_js %}

<style>
    .leaflet-container { 
        width:  100%;
        height: 400px;
    }
</style>

{% endblock %}

{% block extra_script %}
{{ block.super }}
<script type="text/javascript">
    {% autoescape off %}
        var print = "{{GEOSERVER_BASE_URL}}pdf/";
        var config =  {{ viewer|safe }};
        var map = null;
        var bbox = [{{ layer.bbox_string }}];

        $(document).ready(function(){
            map = L.map('preview_map').fitBounds([ [bbox[2],bbox[0]], [bbox[3],bbox[1]] ]);
            var osm = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
              attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            var geonode_layer = L.tileLayer.wms(config.ows_url, {
                layers: config.name,
                format: 'image/png',
                transparent: true
            }).addTo(map);
            
            var baseMaps = {
                "OpenStreetMap": osm
            };
            
            var name = config.name;

            var overlayMaps = {};
            overlayMaps[config.name] = geonode_layer;
            
            var control = L.control.layers(baseMaps, overlayMaps).addTo(map);
        });
    {% endautoescape %}
</script>
{% endblock extra_script %}